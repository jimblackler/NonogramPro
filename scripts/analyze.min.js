function analyzeSequence(a,g,b,d,c,k,h,e,l,f,n,q){if(g==a.length){for(a=c;a<h;a++)if(l?b[e][a]:b[a][e])return!1;if(f)for(b=c;b<h;b++)f[b]=!1;return!0}for(var u=!1,p=a[g],r=0,x=k+p,m=c;m<x;m++)if(l?d[e][m]:d[m][e])r=0;else if((l?b[e][m]:b[m][e])&&m+p<x&&(x=m+p),r+=1,!(r<p||m+1<h&&(l?b[e][m+1]:b[m+1][e]))&&analyzeSequence(a,g+1,b,d,m+2,k+p+1,h,e,l,f,n,q)){var u=!0,v=m-p+1;if(q){for(var t=!0,w=v;w<=m&&t;w++)(l?b[e][w]:b[w][e])||(t=!1);t?-1==q[g]?q[g]=v:q[g]!=v&&(q[g]=-2):q[g]=-3}if(f){m+1<h&&(f[m+1]=
!1);for(t=m;t>=v;)n[t]=!1,t--;for(;t>=c;)f[t]=!1,t--}}return u}function analyzeLine(a,g,b,d,c,k,h,e,l){for(var f=c,n=0,q=0;q<a.length;q++)f-=a[q],f-=n,n=1;return analyzeSequence(a,0,g,b,0,f,c,d,k,h,e,l)}function checkRow(a,g,b,d,c,k){return analyzeLine(c,g,b,d,a.height,!0,void 0,void 0,k)}function checkColumn(a,g,b,d,c,k){return analyzeLine(c,g,b,d,a.width,!1,void 0,void 0,k)}
function analyzePass(a,g,b,d,c){var k=c?a.width:a.height;a=c?a.height:a.width;for(var h=0;h<a;h++){for(var e=[],l=[],f=0;f<k;f++)e.push(!0),l.push(!0);analyzeLine(g[c?0:1][h],b,d,h,k,c,e,l);for(f=0;f<k;f++)e[f]?(console.assert(!l[f]),c?b[h][f]=!0:b[f][h]=!0):l[f]&&(c?d[h][f]=!0:d[f][h]=!0)}}
function analyze(a,g,b){for(var d=getEmpty(a),c=getEmpty(a),k=0,h=!0,e=0;;){var l=clone(d),f=clone(c);analyzePass(a,g,d,c,h);if(equals(d,l)&&equals(c,f)){if(k++,2===k)return-1}else k=0;b(d,l,c,f);if(complete(d,c))return e;h=!h;e++}}
function visualAnalyze(a,g){document.getElementById("dialog").style.visibility="visible";for(var b=document.getElementById("dialog_content");b.firstChild;)b.removeChild(b.firstChild);var d=document.createElement("header");b.appendChild(d);var c=analyze(a,g,function(c,d,e,g){return b.appendChild(draw(a,c,d,e,g))}),c=document.createTextNode(-1==c?"Cannot be completed with standard method.":"Requires "+c+" rounds to complete with standard method.");d.appendChild(c);b.style.width=b.offsetWidth+"px"}
function findHint(a,g,b,d){for(var c=0,k=[-1,-1],h=0;2>h;h++)for(var e=0==h,l=e?a.width:a.height,f=e?a.height:a.width,n=0;n<f;n++){for(var q=[],u=[],p=0;p<l;p++)q.push(!0),u.push(!0);analyzeLine(g[e?0:1][n],b,d,n,l,e,q,u);for(var r=p=0;r<l;r++)q[r]?(console.assert(!u[r]),e?b[n][r]||p++:b[r][n]||p++):u[r]&&(e?d[n][r]||p++:d[r][n]||p++);p>c&&(c=p,k=e?[n,-1]:[-1,n])}return k}
function draw(a,g,b,d,c){var k=document.createElementNS("http://www.w3.org/2000/svg","svg");k.classList.add("mini");a=new Renderer(k,a,{cell_size:10,ratio_for_clues:0});a.paintOnSquares(g,b);a.paintOffSquares(d,c);return k};
